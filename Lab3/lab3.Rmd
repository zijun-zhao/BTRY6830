---
title: "Quantitative Genomics and Genetics 2018"
subtitle: "Computer Lab 3"
author: "Zijun Zhao"
date: "2/15/2018"
output: html_document
---

### Announcements

Homework submission guidelines
Submitting R code: 

- Use Rmarkdown and all working directories should be set to "./" if there are input datasets

- Submit your .Rmd script and compiled pdf. There will be penalties for scripts that fail to compile. (except errors related to missing dependencies - e.g. packages not installed on my computer, just make sure to mention which packages have been called).

--------------------------------------------------------------------------------------

### 1. Visualization 101

#### plot() 

- plot() generates a X-Y plot

- The basic syntax is plot(x-axis, y-axis)

- You can add more information to the plot with axis labels and titles.

```{r ,fig.width = 4,fig.height = 4,fig.align='center' }

x <- seq(-5, 5, by = 0.5) 

y <- x - 3

plot(x, y, 
     xlab = "X axis label here", 
     ylab = "Y axis label here", 
     main = "Plot Title here")

# These two lines draw the red dotted lines marking x = 0, y = 0
# the abline function adds custom lines to the plot generated above
abline(h = 0, lty = 2, col = 'red')
abline(v = 0, lty = 2, col = 'red')

# lty: Line types can either be specified as an integer (0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash) or as one of the character strings "blank", "solid", "dashed", "dotted", "dotdash", "longdash", or "twodash", where "blank" uses ‘invisible lines’ (i.e., does not draw them).
```

- You can also change the points into lines with the type option.

- Ranges for x and y can be specified with xlim and ylim options

```{r ,fig.width = 4,fig.height = 4,fig.align='center' }

plot(x, y,                       # input data
     type = 'l',                 # specifying type, 'p' for points 'l' for lines
     xlab = "X axis label here", # x axis label
     ylab = "Y axis label here", # y axis label
     main = "Plot Title here", # main title
     xlim = c(-10,10), # setting range for x
     ylim = c(-10,10), # setting range for y
     col = 'blue')     # set the color for data points 

# col can be a color name defined in R or a color generated by the function rgb()  
# or a code for a color. (google R colors for more help!)

# the abline function adds custom lines to the plot generated above
abline(h = 0, lty = 2, col = 'red')
abline(v = 0, lty = 2, col = 'red')

```

- You can also plot functions directly with plot(). 

- Here is an example that plots the p.d.f for the normal distribution. 

```{r ,fig.width = 4,fig.height = 4,fig.align='center' }

normal_dist <- function(x, mu = 0, sigma =1) {
  1/ (sigma * sqrt(2 * pi)) * exp( - ((x - mu)^2) / (2 * sigma ^ 2) )
}

plot(normal_dist, xlim = c(-5,5))

```

- To change the mean and standard deviation you would have to called it like this:


```{r ,fig.width = 4,fig.height = 4,fig.align='center' }

plot(function(x) normal_dist(x, mu = 2, sigma = 1), xlim = c(-5,5))

```

#### Histograms 

- The hist() function generates histograms

- Histograms are good to get an initial look at the data. 

```{r ,fig.width = 4,fig.height = 4,fig.align='center', fig.show = 'hold'}
normal.vector <- rnorm(1000) 

# rnorm() generates random points from a normal distribution
# more information about this function will be covered in the next section                     
     
# most basic form
hist(normal.vector)
```

```{r ,fig.width = 8,fig.height = 4,fig.align='center', fig.show = 'hold'}

# adding options

par(mfrow = c(1,2))

hist(normal.vector,                   # input data
     xlab = "X label",                # x axis label
     main = "Histogram with 5 breaks ", # main title 
     col = "skyblue", # setting the fill color for bars
     breaks = 5) # breaks specifies the number of bins

hist(normal.vector,                   # input data
     xlab = "X label",                # x axis label
     main = "Histogram with 20 breaks ", # main title 
     col = "skyblue", # setting the fill color for bars
     breaks = 20) # breaks specifies the number of bins

```

- Setting the option probability to TRUE will change the y axis from counts to probability densities. 

- If you would like a density curve added, you can use lines() with density()

```{r ,fig.width = 4,fig.height = 4,fig.align='center' }
hist(normal.vector,                   # input data
     xlab = "X label",                # x axis label
     main = "Histogram with Density", # main title 
     col = "skyblue", # setting the fill color for bars
     probability = TRUE) # Density instead of counts 

lines(density(normal.vector)) # add a density line to the histogram
```

- You can also save the plots directly into a file. (in this case a png file)

```{r, echo = TRUE, eval = FALSE}

# the png function creates a png file at a custom location. 
# you can also specify the resolution and the size of the image, look up ?png for details
png(file = "./Normal_distribution_histogram.png")

hist(normal.vector, 
     xlab = "X label", 
     main = "Plot saved on disk", 
     col = "skyblue", 
     probability = TRUE)

lines(density(normal.vector)) 

dev.off() # after plotting on the png file, the png file has to be closed in order to save the plot correctly. Otherwise, subsequent plots will be written to the same png file and that means trouble.

```


--------------------------------------------------------------------------------------

### 2. Functions related to the normal distribution

- There are many functions that are built-in for well studied distributions

- Here are some examples for the normal distribution

- Generating random values sampled from a normal distribution with a specified mean and sd

```{r, comment=NA}

# Generate 5 samples drawn from a normal distribution with mean = 0 and sd = 1
rnorm(n = 5, mean = 0, sd = 1)
```

- dnorm() calculates the height of the probability density function at a specific point

- For example, we can plot the density function for a given interval with dnorm()

```{r ,fig.width = 8,fig.height = 4, fig.show = 'hold',fig.align='center' }
par(mfrow = c(1,2)) # setting layout for plots ( 1 x 2 plot window)

x1 <- seq(-5, 0, by = 0.1) 

plot(x1, dnorm(x1, mean = 0,sd = 1),
     ylab = "density", 
     main = "Normal Density for x1",
     pch = 20, cex = 0.5) # pch option changes the style for points 

x2 <- seq(-5, 5, by = 0.1)

plot(x2, dnorm(x2, mean = 0,sd = 1), 
     ylab = "density", 
     main = "Normal Density for x2",
     pch = 20, cex = 0.5) # pch option changes the style for points 


```

- pnorm() returns the value for the cumulative density function for a given point

- We can think of it as the area under the curve up to a certain value for a density function

```{r ,fig.width = 4,fig.height = 4,fig.align='center', echo = FALSE}

plot(x2, dnorm(x2, mean = 0,sd = 1), 
     ylab = "density", 
     main = "Cumulative density, x = -1",
     type = 'l')

x_cord <- c(-5,seq(-5,-1, by = 0.1),-1)
y_cord <- c(0,dnorm(seq(-5,-1, by = 0.1)),0)
polygon(x_cord, y_cord, col = 'skyblue')
```


```{r, comment = NA}
pnorm(-1, mean = 0,sd = 1)
```

```{r ,fig.width = 4,fig.height = 4,fig.align='center', echo = FALSE}
plot(x2, dnorm(x2, mean = 0,sd = 1), 
     ylab = "density", 
     main = "Cumulative density, x = 1",
     type = 'l')

x_cord <- c(-5,seq(-5,1, by = 0.1),1)
y_cord <- c(0,dnorm(seq(-5,1, by = 0.1)),0)
polygon(x_cord, y_cord, col = 'skyblue')
```

```{r, comment = NA}
pnorm(1, mean = 0,sd = 1)
```

- We can also calculate the area from a given point to infinity by setting the lower.tail option to FALSE

- Since the normal distribution is symetric around 0 this should give you the same value as pnorm(-1)

```{r ,fig.width = 4,fig.height = 4,fig.align='center', echo = FALSE}
plot(x2, dnorm(x2, mean = 0,sd = 1), 
     ylab = "density", 
     main = "Cumulative density, x = 1 (<-direction)",
     type = 'l')

x_cord <- c(1,seq(1,5, by = 0.1),5)
y_cord <- c(0,dnorm(seq(1,5, by = 0.1)),0)
polygon(x_cord, y_cord, col = 'skyblue')
```

```{r, comment = NA}
pnorm(1, mean = 0,sd = 1, lower.tail = FALSE)
```

- qnorm() returns the corresponding value for a given quantile 

- Note that the quantiles should be given as values between 0 and 1

```{r ,fig.width = 4,fig.height = 4,fig.align='center', echo = FALSE}
plot(x2, dnorm(x2, mean = 0,sd = 1), 
     ylab = "density", 
     main = "0.1, 0.5, 0.75 - Quantile Values",
     type = 'l')

abline(v = qnorm(0.1), lty = 2, col = 'red')
abline(v = qnorm(0.5), lty = 2, col = 'red')
abline(v = qnorm(0.75), lty = 2, col = 'red')

```

```{r, comment = NA}
qnorm(0.1, mean = 0,sd = 1)  
qnorm(0.5, mean = 0,sd = 1)  
qnorm(0.75, mean = 0,sd = 1)  
```

- The functions are not limited to normal distributions. There are also functions for the uniform distribution, poisson distribution, gamma distribution etc... 

- They have the same form but different suffixes. For example, the function to randomly sample values from a uniform distribution is runif(), the density function is dunif() and so on..

- You can find more information here : http://www.statmethods.net/advgraphs/probability.html


--------------------------------------------------------------------------------------

### Exercise

- Create a function that generates a plot visualizing the area under the curve for a standard normal distribution (where x has the range from -5 to 5) to a given point. (Just like the plots used in the pnorm() section).

**Hints**

- Here is a toy example for drawing a polygon.

```{r ,fig.width = 4,fig.height = 4,fig.align='center'}
x <- seq(-5, 5, by = 0.5) 

y <- 2 * x

plot(x,y)
abline(v = 0, lty = 2, col = 'red')
abline(h = 0, lty = 2, col = 'red')

x_cord <- c(0,2,2)
y_cord <- c(0,4,0)
polygon(x_cord, y_cord, col = 'skyblue')
```

- Example output
```{r , echo = FALSE}
pnorm_viz <- function(input_value){
    x_range <- seq(-5,5, by = 0.1)
    plot(x_range, dnorm(x_range, mean = 0,sd = 1), 
       ylab = "density", 
       main = "Normal distribution from -5 to 5",
       type = 'l')
    
    poly_sequence <- seq(-5,input_value, by = 0.1)
    x_cord <- c(-5,poly_sequence,input_value)
    y_cord <- c(0,dnorm(poly_sequence),0)
    polygon(x_cord, y_cord, col = 'skyblue')
    cat("Area Under the Curve = ", pnorm(input_value), "\n")
}
```

```{r ,fig.width = 4,fig.height = 4,fig.align='center'}
pnorm_viz(-1.5)
```
